package com.example;

import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;

import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.Mockito;
import org.mockito.junit.MockitoJUnitRunner;

import static org.junit.Assert.*; // assertEquals, assertTrue, fail, ...
import static org.mockito.Mockito.*; // when, verify, verifyNoInteractions

@RunWith(MockitoJUnitRunner.class)
public class MyServiceTest {

    @Mock
    private Dependency dep;

    @InjectMocks
    private MyService service;

    @Before
    public void setUp() {
        // init sp√©cifique si besoin
    }

    @Test
    public void should_return_value_from_dependency() {
        when(dep.compute("in")).thenReturn("out");

        String result = service.doWork("in");

        assertEquals("out", result);
        verify(dep).compute("in");
        verifyNoMoreInteractions(dep);
    }

    @Test
    public void should_not_call_dependency_when_input_invalid() {
        String result = service.doWork(null);

        assertNull(result);
        verifyNoInteractions(dep);
    }

    @Test(expected = IllegalStateException.class)
    public void should_throw_when_state_is_invalid() {
        when(dep.isReady()).thenReturn(false);

        service.process(); // doit lever IllegalStateException
    }

    @Test
    public void should_throw_using_try_catch_style() {
        when(dep.isReady()).thenReturn(false);

        try {
            service.process();
            fail("IllegalStateException attendue");
        } catch (IllegalStateException ex) {
            assertTrue(ex.getMessage() == null || ex.getMessage().contains("invalid"));
        }
    }
}